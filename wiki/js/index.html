<!DOCTYPE html>
<html>
	<head>
		<title>Wiki Viewer</title>

		<meta name="viewport"
			  content="width=device-width,
					   user-scalable=no"/>

		<link rel="shortcut icon" type="image/x-icon"
			href="http://quote.frenata.net/favicon.ico" >
		<link rel="icon" type="image/x-icon"
			href="http://quote.frenata.net/favicon.ico" >
		<link rel="stylesheet" type="text/css" href="style.css" />

		<script src="https://ajax.googleapis.com/ajax/
			libs/jquery/3.1.1/jquery.min.js">
		</script>
	</head>
<body>
	<div id="container">
		<div id="search">
			<form id="query">
				<input 
					placeholder="Search the Wiki!" 
					autofocus="true"/>
				<div id="buttons">
					<button id="search-btn">Search</button>
					<button 
						id="random-btn"
						onClick="window.open(
						'https://en.wikipedia.org/wiki/Special:Random'
						); return false;">
						Random
					</button>
				</div>
			</form>
			<form id="random"
				action="https://en.wikipedia.org/wiki/Special:Random"
				method="get"
				target="_blank">
			</form>
		</div>

		<div id="results">
			<!--<h2>Results</h2>-->
		</div>

	</div>
	<script>

$("#query").submit(() => {
	getWiki($("#query input").val());
	return false;
});

function getWiki(search) {
	let url = "https://en.wikipedia.org/w/api.php?" +
		"action=opensearch&format=json&origin=*&search=" + search;
	$.getJSON( url, { })
		.done( response => {
			console.log(response);
			let title = response[1];
			let description = response[2];
			let link = response[3];
			writeWikiResults(title,description,link);
		});
}

function writeWikiResults(title,description,link){
	clearResults();
	for(let i=0;i<title.length;i++){
		appendResult(title[i],description[i],link[i]);
	}
}

function clearResults() {
	//$("#results").html("<h2>Results</h2>");
	$("#results").html("");
}

function appendResult(title,description,link) {
	$("#results").append(
		"<a target=\"_blank\" href=\"" 
		+ link + "\" class=\"result\">" + 
		"<div>" +
		"<h3>"+title+"</h3>" +
		"<p>" + description + "</p>" +
		"</div></a>" );
}

	</script>
</body>
</html>
